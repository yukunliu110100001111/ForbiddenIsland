<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Forbidden Island – Game UI</title>
    <link rel="icon" href="/ForbiddenIsland_war_exploded/favicon.ico" type="image/x-icon" />
    <base href="/ForbiddenIsland_war_exploded/">
    <link href="https://fonts.googleapis.com/css2?family=Merienda:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/game/game.css">
</head>
<body>
<div id="main-container">
    <header id="header">
        <div id="action-status" style="margin:8px; font-weight:bold; text-align:center;"></div> <!-- Current action status display -->
        <div id="control-panel">
            <!-- Main action buttons for player controls -->
            <button id="btn-move" class="color-btn">Move</button>
            <button id="btn-shore" class="color-btn">Shore Up</button>
            <button id="btn-take" class="color-btn">Capture</button>
            <button id="btn-end-turn" class="color-btn">End Turn</button>
        </div>
    </header>
    <div class="main-content">
        <div id="game-wrapper">
            <!-- Left panel containing card decks -->
            <aside id="left-panel">
                <div class="card-pile" id="treasure-deck">
                    <div class="deck-label">Treasure Deck</div>
                </div>
                <div class="card-pile" id="flood-deck">
                    <div class="deck-label">Flood Deck</div>
                </div>

                <div id="discard-piles">
                    <div id="treasure-discard" class="discard-pile"></div> <!-- Treasure discard pile -->
                    <div id="flood-discard" class="discard-pile"></div>    <!-- Flood discard pile -->
                </div>

                <!-- Recently drawn cards display area -->
                <div id="drawn-cards">
                    <div class="drawn-card"></div>
                    <div class="drawn-card"></div>
                </div>
            </aside>

            <!-- Main game map area -->
            <div id="map-container">
                <div id="tiles-layer"></div> <!-- Tile layer for island tiles -->
                <svg id="roads-layer" xmlns="http://www.w3.org/2000/svg"></svg> <!-- SVG layer for paths/connections -->
            </div>

            <!-- Right panel with water meter and action log -->
            <aside id="right-panel">
                <div id="water-meter" class="water-meter">
                    <img src="assets/Images/bg/watermeter.png" alt="Water Meter" class="watermeter-bg" />
                    <img src="assets/Images/bg/pointer.png" class="watermeter-pointer" alt="pointer" />
                    <div class="watermeter-label" id="watermeter-label">1 / 6</div> <!-- Water level indicator -->
                </div>
                <div id="action-log-container">
                    <div id="action-log-title">History</div>
                    <div id="action-log"></div> <!-- Game action history log -->
                </div>
            </aside>
        </div>

        <!-- Bottom panel showing player avatars and hands -->
        <div class="bottom-panel-group">
            <footer id="players-footer">
                <!-- 这里给每个 .player 都加上 data-player-index -->
                <div class="player" data-player-index="0">
                    <div class="avatar"></div>
                    <div class="hand"></div>
                </div>
                <div class="player" data-player-index="1">
                    <div class="avatar"></div>
                    <div class="hand"></div>
                </div>
                <div class="player" data-player-index="2">
                    <div class="avatar"></div>
                    <div class="hand"></div>
                </div>
                <!-- 假设最后一个是 “自己” -->
                <div class="player me" data-player-index="3">
                    <div class="avatar"></div>
                    <div class="hand"></div>
                </div>
            </footer>
        </div>
    </div>
</div>

<!-- Game result modal -->
<div id="result-modal" class="modal hidden">
    <div class="modal-content">
        <h2 id="result-title"></h2>
        <button id="btn-restart">Restart</button>
    </div>
</div>

<!-- Special card usage modal -->
<div id="special-modal" class="modal hidden">
    <div class="modal-content">
        <h2>Special Card</h2>
        <div id="special-list" class="special-list">
            <!-- Will be dynamically populated with special action cards -->
        </div>
        <button id="btn-special-close">Cancel</button>
    </div>
</div>

<!-- Card discard selection modal -->
<div id="discard-modal" class="modal hidden">
    <div class="modal-content">
        <h2>Select cards to discard</h2>
        <div id="discard-cards-container" class="discard-cards"></div>
        <p>Click cards until you have 5 or fewer in hand</p>
    </div>
</div>

<script src="assets/js/ui-plugins.js"></script>
<script type="module">
    import { bindInGame } from './assets/js/binders/inGameBinder.js';
    document.addEventListener('DOMContentLoaded', () => {
        bindInGame(); // Initialize game bindings when DOM is loaded
    });
</script>
</body>
</html>
